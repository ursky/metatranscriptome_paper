> library(cummeRbund)
library(cummeRbund)
install.packages("ggplot2")
install.packages("cummeRbund")
source("https://bioconductor.org/biocLite.R")
biocLite("cummeRbund")
library(cummeRbund)
library(cummeRbund)
biocLite("cummeRbund")
install.packages("RCurl")
install.packages("RCurl")
install.packages("XML")
install.packages("XML")
install.packages("XML")
source("https://bioconductor.org/biocLite.R")
install.packages("RCurl")
install.packages("XML")
install.packages("XML")
install.packages("RCurl")
source("https://bioconductor.org/biocLite.R")
biocLite("cummeRbund")
library(cummeRbund)
biocLite("cummeRbund")
install.packages("XML")
source("https://bioconductor.org/biocLite.R")
biocLite("cummeRbund")
library(cummeRbund)
install.packages("XML")
install.packages("XML")
install.packages("XML")
install.packages("XML")
install.packages("XML")
install.packages("XML")
install.packages("XML")
install.packages("XML")
install.packages("XML")
source("http://bioconductor.org/biocLite.R")
biocLite()
biocLite("cummerbund")
biocLite("cummeRbund")
source("http://bioconductor.org/biocLite.R")
biocLite("cummeRbund")
biocLite("cummeRbund")
source("http://bioconductor.org/biocLite.R")
biocLite("cummeRbund")
quit()
source("http://bioconductor.org/biocLite.R")
biocLite("cummeRbund")
quit()
source("http://bioconductor.org/biocLite.R")
biocLite("cummeRbund")
biocLite("cummeRbund")
biocLite("acepack")
biocLite("cummeRbund")
biocLite("Hmisc")
biocLite("cummeRbund")
library(cummerbund)
library(cummeRbund)
quit()
source('http://bioconductor.org/biocLite.R'); biocLite("biomformat")
quit()
library(tximportData)
library(tximport)
library("DESeq2")
library("vsn")
library("RColorBrewer")
setwd("/Users/guritsk1/Desktop/RNA_SEQ_2017/DESeq2_analysis/MAG_ANALYSIS/BIN_algae")
samples <- read.table("samples.txt", header = TRUE)
names(files) <- paste0("sample", 1:6)
files <- file.path("salmon_out", samples$Dir, "quant.sf")
all(file.exists(files))
txi <- tximport(files, type = "salmon", txOut = TRUE)
names(txi)
head(txi$counts)
ddsTxi <- DESeqDataSetFromTximport(txi, colData = samples, design = ~ Time)
keep <- rowSums(counts(ddsTxi)) >= 1
dds <- ddsTxi[keep,]
dds <- DESeq(dds)
res <- results(dds, alpha=0.05) #(FDR=5%)
write.csv(as.data.frame(resOrdered), file="significance_results.csv")
resOrdered <- res[order(res$pvalue),]
summary(res)
sum(res$padj < 0.01, na.rm=TRUE)
vsd <- vst(dds, blind=FALSE)
vsd <- varianceStabilizingTransformation(dds, blind=FALSE)
rld <- rlog(dds, blind=FALSE)
head(assay(vsd), 3)
sampleDists <- dist(t(assay(vsd)))
sampleDistMatrix <- as.matrix(sampleDists)
rownames(sampleDistMatrix) <- paste(vsd$Time, vsd$Day, sep="-")
colnames(sampleDistMatrix) <- NULL
colors <- colorRampPalette( rev(brewer.pal(9, "Blues")) )(255)
heatmap(sampleDistMatrix, clustering_distance_rows=sampleDists, clustering_distance_cols=sampleDists, col=colors)
plotPCA(vsd, intgroup="Time")
plotMA(res, ylim=c(-2,2))
plotCounts(dds, gene=which.min(res$padj), intgroup="Time") # plot expresison of most differential gene
sum(res$padj < 0.01, na.rm=TRUE)
plotMA(res, ylim=c(-2,2))
heatmap(sampleDistMatrix, clustering_distance_rows=sampleDists, clustering_distance_cols=sampleDists, col=colors)
plotCounts(dds, gene=which.min(res$padj), intgroup="Time") # plot expresison of most differential gene
plotPCA(vsd, intgroup="Time")
setwd("/Users/guritsk1/Desktop/RNA_SEQ_2017/DESeq2_analysis/MAG_ANALYSIS/BIN_chloroplast")
samples <- read.table("samples.txt", header = TRUE)
names(files) <- paste0("sample", 1:6)
files <- file.path("salmon_out", samples$Dir, "quant.sf")
all(file.exists(files))
txi <- tximport(files, type = "salmon", txOut = TRUE)
names(txi)
head(txi$counts)
ddsTxi <- DESeqDataSetFromTximport(txi, colData = samples, design = ~ Time)
keep <- rowSums(counts(ddsTxi)) >= 1
dds <- ddsTxi[keep,]
dds <- DESeq(dds)
res <- results(dds, alpha=0.05) #(FDR=5%)
write.csv(as.data.frame(resOrdered), file="significance_results.csv")
resOrdered <- res[order(res$pvalue),]
summary(res)
sum(res$padj < 0.01, na.rm=TRUE)
vsd <- vst(dds, blind=FALSE)
vsd <- varianceStabilizingTransformation(dds, blind=FALSE)
rld <- rlog(dds, blind=FALSE)
head(assay(vsd), 3)
sampleDists <- dist(t(assay(vsd)))
sampleDistMatrix <- as.matrix(sampleDists)
rownames(sampleDistMatrix) <- paste(vsd$Time, vsd$Day, sep="-")
colnames(sampleDistMatrix) <- NULL
colors <- colorRampPalette( rev(brewer.pal(9, "Blues")) )(255)
plotMA(res, ylim=c(-2,2))
heatmap(sampleDistMatrix, clustering_distance_rows=sampleDists, clustering_distance_cols=sampleDists, col=colors)
plotCounts(dds, gene=which.min(res$padj), intgroup="Time") # plot expresison of most differential gene
plotPCA(vsd, intgroup="Time")
sum(res$padj < 0.01, na.rm=TRUE)
setwd("/Users/guritsk1/Desktop/RNA_SEQ_2017/DESeq2_analysis/MAG_ANALYSIS/BIN_6")
samples <- read.table("samples.txt", header = TRUE)
files <- file.path("salmon_out", samples$Dir, "quant.sf")
names(files) <- paste0("sample", 1:6)
all(file.exists(files))
txi <- tximport(files, type = "salmon", txOut = TRUE)
names(txi)
head(txi$counts)
ddsTxi <- DESeqDataSetFromTximport(txi, colData = samples, design = ~ Time)
keep <- rowSums(counts(ddsTxi)) >= 1
dds <- ddsTxi[keep,]
dds <- DESeq(dds)
res <- results(dds, alpha=0.05) #(FDR=5%)
write.csv(as.data.frame(resOrdered), file="significance_results.csv")
resOrdered <- res[order(res$pvalue),]
summary(res)
sum(res$padj < 0.01, na.rm=TRUE)
vsd <- vst(dds, blind=FALSE)
vsd <- varianceStabilizingTransformation(dds, blind=FALSE)
rld <- rlog(dds, blind=FALSE)
head(assay(vsd), 3)
sampleDists <- dist(t(assay(vsd)))
sampleDistMatrix <- as.matrix(sampleDists)
rownames(sampleDistMatrix) <- paste(vsd$Time, vsd$Day, sep="-")
colors <- colorRampPalette( rev(brewer.pal(9, "Blues")) )(255)
colnames(sampleDistMatrix) <- NULL
plotMA(res, ylim=c(-2,2))
heatmap(sampleDistMatrix, clustering_distance_rows=sampleDists, clustering_distance_cols=sampleDists, col=colors)
sum(res$padj < 0.01, na.rm=TRUE)
plotPCA(vsd, intgroup="Time")
plotCounts(dds, gene=which.min(res$padj), intgroup="Time") # plot expresison of most differential gene
plotPCA(vsd, intgroup="Time")
samples <- read.table("samples.txt", header = TRUE)
names(files) <- paste0("sample", 1:6)
files <- file.path("salmon_out", samples$Dir, "quant.sf")
all(file.exists(files))
txi <- tximport(files, type = "salmon", txOut = TRUE)
names(txi)
head(txi$counts)
ddsTxi <- DESeqDataSetFromTximport(txi, colData = samples, design = ~ Time)
keep <- rowSums(counts(ddsTxi)) >= 1
dds <- ddsTxi[keep,]
dds <- DESeq(dds)
res <- results(dds, alpha=0.05) #(FDR=5%)
write.csv(as.data.frame(resOrdered), file="significance_results.csv")
resOrdered <- res[order(res$pvalue),]
summary(res)
sum(res$padj < 0.01, na.rm=TRUE)
vsd <- vst(dds, blind=FALSE)
vsd <- varianceStabilizingTransformation(dds, blind=FALSE)
rld <- rlog(dds, blind=FALSE)
head(assay(vsd), 3)
sampleDists <- dist(t(assay(vsd)))
sampleDistMatrix <- as.matrix(sampleDists)
rownames(sampleDistMatrix) <- paste(vsd$Time, vsd$Day, sep="-")
colnames(sampleDistMatrix) <- NULL
colors <- colorRampPalette( rev(brewer.pal(9, "Blues")) )(255)
plotMA(res, ylim=c(-2,2))
heatmap(sampleDistMatrix, clustering_distance_rows=sampleDists, clustering_distance_cols=sampleDists, col=colors)
plotCounts(dds, gene=which.min(res$padj), intgroup="Time") # plot expresison of most differential gene
plotPCA(vsd, intgroup="Time")
setwd("/Users/guritsk1/Desktop/RNA_SEQ_2017/DESeq2_analysis/MAG_ANALYSIS/BIN_17")
samples <- read.table("samples.txt", header = TRUE)
names(files) <- paste0("sample", 1:6)
files <- file.path("salmon_out", samples$Dir, "quant.sf")
all(file.exists(files))
txi <- tximport(files, type = "salmon", txOut = TRUE)
names(txi)
head(txi$counts)
ddsTxi <- DESeqDataSetFromTximport(txi, colData = samples, design = ~ Time)
keep <- rowSums(counts(ddsTxi)) >= 1
dds <- ddsTxi[keep,]
dds <- DESeq(dds)
res <- results(dds, alpha=0.05) #(FDR=5%)
write.csv(as.data.frame(resOrdered), file="significance_results.csv")
resOrdered <- res[order(res$pvalue),]
summary(res)
sum(res$padj < 0.01, na.rm=TRUE)
vsd <- vst(dds, blind=FALSE)
vsd <- varianceStabilizingTransformation(dds, blind=FALSE)
rld <- rlog(dds, blind=FALSE)
head(assay(vsd), 3)
sampleDists <- dist(t(assay(vsd)))
sampleDistMatrix <- as.matrix(sampleDists)
rownames(sampleDistMatrix) <- paste(vsd$Time, vsd$Day, sep="-")
colnames(sampleDistMatrix) <- NULL
colors <- colorRampPalette( rev(brewer.pal(9, "Blues")) )(255)
plotMA(res, ylim=c(-2,2))
heatmap(sampleDistMatrix, clustering_distance_rows=sampleDists, clustering_distance_cols=sampleDists, col=colors)
plotCounts(dds, gene=which.min(res$padj), intgroup="Time") # plot expresison of most differential gene
plotPCA(vsd, intgroup="Time")
sum(res$padj < 0.01, na.rm=TRUE)
plotMA(res, ylim=c(-2,2))
heatmap(sampleDistMatrix, clustering_distance_rows=sampleDists, clustering_distance_cols=sampleDists, col=colors)
plotPCA(vsd, intgroup="Time")
samples <- read.table("samples.txt", header = TRUE)
names(files) <- paste0("sample", 1:6)
files <- file.path("salmon_out", samples$Dir, "quant.sf")
all(file.exists(files))
txi <- tximport(files, type = "salmon", txOut = TRUE)
names(txi)
head(txi$counts)
ddsTxi <- DESeqDataSetFromTximport(txi, colData = samples, design = ~ Time)
keep <- rowSums(counts(ddsTxi)) >= 1
dds <- ddsTxi[keep,]
dds <- DESeq(dds)
res <- results(dds, alpha=0.05) #(FDR=5%)
write.csv(as.data.frame(resOrdered), file="significance_results.csv")
resOrdered <- res[order(res$pvalue),]
summary(res)
sum(res$padj < 0.01, na.rm=TRUE)
vsd <- vst(dds, blind=FALSE)
vsd <- varianceStabilizingTransformation(dds, blind=FALSE)
rld <- rlog(dds, blind=FALSE)
head(assay(vsd), 3)
sampleDists <- dist(t(assay(vsd)))
sampleDistMatrix <- as.matrix(sampleDists)
rownames(sampleDistMatrix) <- paste(vsd$Time, vsd$Day, sep="-")
colnames(sampleDistMatrix) <- NULL
colors <- colorRampPalette( rev(brewer.pal(9, "Blues")) )(255)
plotMA(res, ylim=c(-2,2))
heatmap(sampleDistMatrix, clustering_distance_rows=sampleDists, clustering_distance_cols=sampleDists, col=colors)
plotCounts(dds, gene=which.min(res$padj), intgroup="Time") # plot expresison of most differential gene
plotPCA(vsd, intgroup="Time")
sum(res$padj < 0.01, na.rm=TRUE)
samples <- read.table("samples.txt", header = TRUE)
names(files) <- paste0("sample", 1:6)
files <- file.path("salmon_out", samples$Dir, "quant.sf")
all(file.exists(files))
txi <- tximport(files, type = "salmon", txOut = TRUE)
names(txi)
head(txi$counts)
ddsTxi <- DESeqDataSetFromTximport(txi, colData = samples, design = ~ Time)
keep <- rowSums(counts(ddsTxi)) >= 1
dds <- ddsTxi[keep,]
dds <- DESeq(dds)
res <- results(dds, alpha=0.05) #(FDR=5%)
write.csv(as.data.frame(resOrdered), file="significance_results.csv")
resOrdered <- res[order(res$pvalue),]
summary(res)
sum(res$padj < 0.01, na.rm=TRUE)
vsd <- vst(dds, blind=FALSE)
vsd <- varianceStabilizingTransformation(dds, blind=FALSE)
rld <- rlog(dds, blind=FALSE)
head(assay(vsd), 3)
sampleDists <- dist(t(assay(vsd)))
sampleDistMatrix <- as.matrix(sampleDists)
rownames(sampleDistMatrix) <- paste(vsd$Time, vsd$Day, sep="-")
colnames(sampleDistMatrix) <- NULL
colors <- colorRampPalette( rev(brewer.pal(9, "Blues")) )(255)
plotMA(res, ylim=c(-2,2))
heatmap(sampleDistMatrix, clustering_distance_rows=sampleDists, clustering_distance_cols=sampleDists, col=colors)
plotCounts(dds, gene=which.min(res$padj), intgroup="Time") # plot expresison of most differential gene
plotPCA(vsd, intgroup="Time")
